#!/bin/bash

if ! command -v typst >/dev/null 2>&1; then
    echo "Typst compiler not found"
    exit 1
fi

if [ "$#" -ne 2 ]; then
    echo "Usage: $0 <filename_csv> <out_filename>"
    echo "Converts teamsOut.csv generated by contest_utils into a PDF file"
    exit 1
fi

file="$1"
dir=$(mktemp -d)

if [ ! -f "$file" ]; then
    echo "Error: File '$file' does not exist."
    exit 1
fi

cp "$file" "$dir/in.csv"
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
cp "$SCRIPT_DIR/templ.typ" "$dir"

typst compile "$dir/templ.typ" "$2"

echo "Produced file."
